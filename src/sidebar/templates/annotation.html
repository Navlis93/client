<header class="annotation-header" ng-if="!vm.user()">
  <strong>You must be logged in to create annotations.</strong>
</header>

<div ng-keydown="vm.onKeydown($event)" ng-if="vm.user()">

  <!-- Excerpts -->
  <section class="annotation-quote-list"
    ng-class="{'is-orphan' : vm.isOrphan()}"
    ng-if="vm.quote()">
    <excerpt collapsed-height="35"
      inline-controls="true"
      overflow-hysteresis="20"
      content-data="selector.exact">
      <blockquote class="annotation-quote"
        h-branding="selectionFontFamily"
        ng-bind="vm.quote()"
        ng-style="vm.annotationStyle()"></blockquote>
    </excerpt>
  </section>

  <!-- / Excerpts -->

  <!-- Body -->
  <section name="text" class="annotation-body">
    <excerpt enabled="!vm.editing()"
      inline-controls="false"
      on-collapsible-changed="vm.setBodyCollapsible(collapsible)"
      collapse="vm.collapseBody"
      collapsed-height="400"
      overflow-hysteresis="20"
      content-data="vm.state().text">
      <markdown text="vm.state().text"
                custom-text-class="{'annotation-body is-hidden':vm.isHiddenByModerator(),
                                    'has-content':vm.hasContent()}"
                on-edit-text="vm.setText(text)"
                read-only="!vm.editing()">
      </markdown>
    </excerpt>
  </section>
  <!-- / Body -->


    <!-- Type -->
  <div class="annotation-body form-field" ng-if="vm.editing()">
<!--     <type-editor type="vm.state().type"
                on-edit-type="vm.setType(type)"></type-editor> -->
  </div>

  <div class="annotation-body u-layout-row tags tags-read-only"
       ng-if="vm.editing()">
    <div class="u-stretch"></div>
  </div>

<!--   <select ng-model="data.annotation_type"
          ng-options="v.id as v.title for (k, v) in vm.getAvailableTypes()"
          ng-change=setType()>
     <option value="">Select Type</option>
  </select> -->
  <!-- / Type -->

  <footer class="annotation-footer">
    <div class="annotation-form-actions" ng-if="vm.editing()">
      <publish-annotation-btn
        class="publish-annotation-btn"
        group="vm.group()"
        can-post="vm.hasContent()"
        is-shared="vm.isShared()"
        on-cancel="vm.revert()"
        on-save="vm.save()"
        on-set-privacy="vm.setPrivacy(level)"></publish-annotation-btn>
    </div>

    <div class="annotation-section annotation-license"
         ng-show="vm.shouldShowLicense()">
      <a class="annotation-license__link" href="http://creativecommons.org/publicdomain/zero/1.0/"
        title="View more information about the Creative Commons Public Domain dedication"
        target="_blank">
        <i class="h-icon-cc-logo"></i><i class="h-icon-cc-zero"></i>
        Annotations can be freely reused by anyone for any purpose.
      </a>
    </div>

    <div class="annotation-replies" ng-if="!vm.isReply() && vm.replyCount > 0">
      <a href=""
        ng-click="vm.onReplyCountClick()">
        <span class="annotation-replies__link">{{ vm.isCollapsed ? 'Show replies' : 'Hide replies' }}</span>
        <span class="annotation-replies__count">({{ vm.replyCount }})</span>
      </a>
    </div>

    <div class="annotation-actions" ng-if="vm.isSaving">
      Saving...
    </div>

    <div class="annotation-actions" ng-if="!vm.isSaving && !vm.editing() && vm.id()">
      <div ng-show="vm.isSaving">Savingâ€¦</div>
      <annotation-action-button
        icon="'h-icon-annotation-edit'"
        is-disabled="vm.isDeleted()"
        label="'Edit'"
        ng-show="vm.authorize('update') && !vm.isSaving"
        on-click="vm.edit()"
      ></annotation-action-button>
      <annotation-action-button
        icon="'h-icon-annotation-delete'"
        is-disabled="vm.isDeleted()"
        label="'Delete'"
        ng-show="vm.authorize('delete')"
        on-click="vm.delete()"
      ></annotation-action-button>
    </div>
  </footer>
</div>
